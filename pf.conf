# Macros
int_if = "em1"          # Interface facing Client (10.x)
ext_if = "em2"          # Interface facing Server (20.x)
server_ip = "192.168.20.2"

# 1. NAT (Network Address Translation)
# Map traffic from Client (10.0/24) to the Router's External IP (20.1)
nat on $ext_if from 192.168.10.0/24 to any -> ($ext_if)

# 2. RDR (Port Forwarding)
# Forward HTTP traffic hitting the Router (10.2) to the Server (20.2)
rdr on $int_if proto tcp from any to ($int_if) port 80 -> $server_ip

# 3. Firewall Rules (Default Deny Policy)
block all

# Allow Loopback (Essential)
set skip on lo0

# Allow HTTP (80) and HTTPS (443)
pass in on $int_if proto tcp from 192.168.10.0/24 to any port { 80, 443 }
pass out on $ext_if proto tcp to any port { 80, 443 }

# Allow SSH (Only for management, optional)
# pass in proto tcp to any port 22
